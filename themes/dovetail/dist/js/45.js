(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{319:function(e,t,a){"use strict";a.r(t);var s=a(12),r=a(39),n=a(44),i=a(76),o=a(75),d=a(6);function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){u(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function u(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var m={beforeRouteLeave:function(e,t,a){this.resource.isPrestine?a():this.askUserBeforeNavigatingAway(a)},components:{SkeletonEditCompany:i.a,SkeletonEditFinancial:o.a,SendFinancialDataToCrmButton:n.a},computed:c({},Object(d.c)({isDense:"settings/fieldIsDense",shortkeyCtrlIsPressed:"shortkey/ctrlIsPressed"}),{isDesktop:function(){return this.$vuetify.breakpoint.mdAndUp},isInvalid:function(){return this.resource.isPrestine||this.resource.loading},isLoading:function(){return this.resource.loading},isFormDisabled:function(){return this.isInvalid||this.resource.isPrestine},isFormPrestine:function(){return this.resource.isPrestine},isNotFormPrestine:function(){return!this.isFormPrestine},isFetchingResource:function(){return this.loading},isFinishedFetchingResource:function(){return!this.loading}}),data:function(e){return{resource:new r.a,loading:!0,tabsModel:1}},methods:c({},Object(d.b)({hideSidebar:"sidebar/hide",hideAlertbox:"alertbox/hide",hideDialog:"dialog/hide",hideErrorbox:"errorbox/hide",hideSnackbar:"snackbar/hide",hideSuccessbox:"successbox/hide",showAlertbox:"alertbox/show",showDialog:"dialog/show",showErrorbox:"errorbox/show",showSnackbar:"snackbar/show",showSuccessbox:"successbox/show"}),{askUserBeforeNavigatingAway:function(e){var t=this;this.showDialog({illustration:function(){return Promise.resolve().then(a.bind(null,529))},title:trans("Unsaved changes will be lost"),text:trans("You have unsaved changes on this page. If you navigate away from this page, data will not be recovered."),buttons:{cancel:{text:trans("Go Back"),callback:function(){t.hideDialog()}},action:{text:trans("Discard"),callback:function(){e(),t.hideDialog()}}}})},askUserToDiscardUnsavedChanges:function(){var e=this;this.showDialog({illustration:function(){return Promise.resolve().then(a.bind(null,529))},title:trans("Discard changes?"),text:trans("You have unsaved changes on this page. If you navigate away from this page, data will not be recovered."),buttons:{cancel:{text:trans("Cancel"),callback:function(){e.hideDialog()}},action:{text:trans("Discard"),callback:function(){e.hideDialog(),e.$router.replace({name:"companies.owned"})}}}})},load:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.resource.loading=e,this.loading=e},formIsChanged:function(){this.resource.isPrestine=!1},parseResourceData:function(e){_.clone(e);var t=new FormData(this.$refs["updateform-form"].$el);return t.append("_method","put"),t},parseErrors:function(e){return this.$refs.updateform.setErrors(e),e=Object.values(e).flat(),this.resource.hasErrors=e.length,this.resource.errors},getParseErrors:function(e){return e=Object.values(e).flat(),this.resource.hasErrors=e.length,e},submitForm:function(){this.isFormDisabled||(this.$refs["submit-button"].click(),window.scrollTo({top:0,left:0,behavior:"smooth"}))},submit:function(e){var t=this;this.load(),e.preventDefault(),axios.post(s.a.update(this.resource.data.id),this.parseResourceData(this.resource.data)).then((function(e){t.resource.isPrestine=!0,t.showSuccessbox({text:trans("Company updated successfully"),buttons:{show:{code:"customers.show",to:{name:"companies.show",params:{id:t.resource.data.id}},icon:"mdi-briefcase-search-outline",text:trans("Go to Survey Page")},create:{code:"crm.search",to:{name:"companies.find"},icon:"mdi-file-document-box-search-outline",text:trans("Find Another Company")}}})})).catch((function(e){if(e.response&&e.response.status==Response.HTTP_UNPROCESSABLE_ENTITY){_.size(e.response.data.errors);t.$refs.updateform.setErrors(e.response.data.errors),t.showErrorbox({text:trans(e.response.data.message),errors:e.response.data.errors})}})).finally((function(){t.load(!1)}))},getResource:function(){var e=this;this.resource.loading=!0,this.resource.isPrestine=!1,axios.get(s.a.show(this.$route.params.id)).then((function(t){e.resource.data=t.data.data,e.resource.metadata=_.merge({},e.resource.metadata,e.resource.data.metadata),e.resource.data.financials=e.resource.metadata})).finally((function(){e.load(!1),e.resource.isPrestine=!0}))},activateTab:function(){this.tabsModel=parseInt(this.$route.query.tab||0)}}),mounted:function(){this.hideSidebar(),this.getResource(),this.activateTab()},watch:{"resource.data":{handler:function(e){this.resource.isPrestine=!1,this.resource.hasErrors=this.$refs.updateform.flags.invalid,this.resource.hasErrors||this.hideAlertbox()},deep:!0}}},f=a(0),v=a(2),p=a.n(v),h=a(590),b=a(107),y=a(264),g=a(1),x=a(583),k=a(584),w=a(5),C=a(597),P=a(93),S=a(585),D=a(352),F=a(586),O=a(361),I=a(50),T=a(19),E=Object(f.a)(m,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("admin",{scopedSlots:e._u([{key:"appbar",fn:function(){return[a("v-container",{staticClass:"py-0 px-0"},[a("v-row",{attrs:{justify:"space-between",align:"center"}},[a("v-fade-transition",[e.isNotFormPrestine?a("v-col",{staticClass:"py-0",attrs:{cols:"auto"}},[a("v-toolbar-title",{staticClass:"muted--text"},[e._v(e._s(e.trans("Unsaved changes")))])],1):e._e()],1),e._v(" "),a("v-spacer"),e._v(" "),a("v-col",{staticClass:"py-0",attrs:{cols:"auto"}},[a("div",{staticClass:"d-flex justify-end"},[a("v-spacer"),e._v(" "),a("v-btn",{staticClass:"ml-3 mr-0",attrs:{text:"",large:""},on:{click:e.askUserToDiscardUnsavedChanges}},[e._v(e._s(e.trans("Discard")))]),e._v(" "),a("v-badge",{staticClass:"dt-badge",attrs:{bordered:"",bottom:"",color:"dark",content:"s","offset-x":"20","offset-y":"20",tile:"",transition:"fade-transition"},model:{value:e.shortkeyCtrlIsPressed,callback:function(t){e.shortkeyCtrlIsPressed=t},expression:"shortkeyCtrlIsPressed"}},[a("v-btn",{directives:[{name:"shortkey",rawName:"v-shortkey.once",value:["ctrl","s"],expression:"['ctrl', 's']",modifiers:{once:!0}}],ref:"submit-button-main",staticClass:"ml-3 mr-0",attrs:{disabled:e.isFormDisabled,loading:e.isLoading,color:"primary",large:"",type:"submit"},on:{click:function(t){return t.preventDefault(),e.submitForm(t)},shortkey:e.submitForm}},[a("v-icon",{attrs:{left:""}},[e._v("mdi-content-save-outline")]),e._v("\n                "+e._s(e.trans("Update"))+"\n              ")],1)],1)],1)])],1)],1)]},proxy:!0}])},[a("metatag",{attrs:{title:e.resource.data.name}}),e._v(" "),a("back-to-top"),e._v(" "),e._v(" "),a("validation-observer",{ref:"updateform",scopedSlots:e._u([{key:"default",fn:function(t){var s=t.handleSubmit;t.errors,t.invalid,t.passed;return[a("v-form",{ref:"updateform-form",attrs:{disabled:e.isLoading,autocomplete:"false"},on:{change:e.formIsChanged,submit:function(t){t.preventDefault(),s(e.submit(t))}}},[a("button",{ref:"submit-button",staticClass:"d-none",attrs:{disabled:e.isFormDisabled,type:"submit"}}),e._v(" "),a("page-header",{attrs:{back:{to:{name:"companies.owned"},text:e.trans("Companies")}},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("\n          "+e._s(e.trans("Edit :name",{name:e.resource.data.name+"'s Input Data"}))+"\n        ")]},proxy:!0},{key:"action",fn:function(){return[a("validation-provider",{attrs:{vid:"metadata[type]",name:e.trans("Type"),rules:"email"},scopedSlots:e._u([{key:"default",fn:function(t){t.errors;return[a("div",[a("label",[e._v("Audited Financials")]),e._v(" "),a("input",{attrs:{type:"radio",name:"metadata[type]",value:"Audited"},domProps:{checked:"Audited"==e.resource.data.metadata.type}}),e._v(" "),a("span",{staticClass:"d-inline-block mx-3"}),e._v(" "),a("label",[e._v("In-House Financials")]),e._v(" "),a("input",{attrs:{type:"radio",name:"metadata[type]",value:"In-House"},domProps:{checked:"In-House"==e.resource.data.metadata.type}})])]}}],null,!0)})]},proxy:!0}],null,!0)}),e._v(" "),a("alertbox"),e._v(" "),a("input",{attrs:{type:"hidden",name:"name"},domProps:{value:e.resource.data.name}}),e._v(" "),a("input",{attrs:{type:"hidden",name:"code"},domProps:{value:e.resource.data.code}}),e._v(" "),a("input",{attrs:{type:"hidden",name:"refnum"},domProps:{value:e.resource.data.refnum}}),e._v(" "),a("input",{attrs:{type:"hidden",name:"user_id"},domProps:{value:e.resource.data.user_id}}),e._v(" "),a("v-row",[a("v-col",{attrs:{cols:"12",md:"12"}},[a("v-card",{attrs:{flat:"",color:"transparent"}},[a("tabs",{scopedSlots:e._u([{key:"item",fn:function(){return[a("v-tab-item",{key:"tab-0"},[e.isFetchingResource?[a("skeleton-edit-company")]:e._e(),e._v(" "),a("v-card",{directives:[{name:"show",rawName:"v-show",value:e.isFinishedFetchingResource,expression:"isFinishedFetchingResource"}]},[a("v-card-text",[a("validation-provider",{attrs:{vid:"name",name:e.trans("Name"),rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("v-text-field",{staticClass:"dt-text-field",attrs:{dense:e.isDense,disabled:e.isLoading,"error-messages":s,label:e.trans("Company Name"),autofocus:"",name:"name",outlined:"","prepend-inner-icon":"mdi-briefcase-outline"},model:{value:e.resource.data.name,callback:function(t){e.$set(e.resource.data,"name",t)},expression:"resource.data.name"}})]}}],null,!0)}),e._v(" "),a("validation-provider",{attrs:{vid:"metadata[email]",name:e.trans("Email"),rules:"email"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("v-text-field",{staticClass:"dt-text-field",attrs:{dense:e.isDense,disabled:e.isLoading,"error-messages":s,label:e.trans("Company Email"),autofocus:"",name:"metadata[email]",outlined:"","prepend-inner-icon":"mdi-email-outline"},model:{value:e.resource.data.metadata.email,callback:function(t){e.$set(e.resource.data.metadata,"email",t)},expression:"resource.data.metadata['email']"}})]}}],null,!0)}),e._v(" "),a("validation-provider",{attrs:{vid:"metadata[address]",name:e.trans("Company Address")},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("v-text-field",{staticClass:"dt-text-field",attrs:{dense:e.isDense,disabled:e.isLoading,"error-messages":s,label:e.trans("Company Address"),autofocus:"",name:"metadata[address]",outlined:"","prepend-inner-icon":"mdi-map-marker"},model:{value:e.resource.data.metadata.address,callback:function(t){e.$set(e.resource.data.metadata,"address",t)},expression:"resource.data.metadata['address']"}})]}}],null,!0)}),e._v(" "),a("validation-provider",{attrs:{vid:"metadata[website]",name:e.trans("Website")},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("v-text-field",{staticClass:"dt-text-field",attrs:{dense:e.isDense,disabled:e.isLoading,"error-messages":s,label:e.trans("Website"),autofocus:"",name:"metadata[website]",outlined:"","prepend-inner-icon":"mdi-earth"},model:{value:e.resource.data.metadata.website,callback:function(t){e.$set(e.resource.data.metadata,"website",t)},expression:"resource.data.metadata['website']"}})]}}],null,!0)}),e._v(" "),a("validation-provider",{attrs:{vid:"metadata[staffstrength]",name:e.trans("Staff Strength")},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("v-text-field",{staticClass:"dt-text-field",attrs:{dense:e.isDense,disabled:e.isLoading,"error-messages":s,label:e.trans("Staff Strength"),autofocus:"",name:"metadata[staffstrength]",outlined:"",type:"number"},model:{value:e.resource.data.metadata.staffstrength,callback:function(t){e.$set(e.resource.data.metadata,"staffstrength",t)},expression:"resource.data.metadata['staffstrength']"}})]}}],null,!0)}),e._v(" "),a("validation-provider",{attrs:{vid:"metadata[industry]",name:e.trans("Industry")},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("v-text-field",{staticClass:"dt-text-field",attrs:{dense:e.isDense,disabled:e.isLoading,"error-messages":s,label:e.trans("Industry"),name:"metadata[industry]",outlined:""},model:{value:e.resource.data.metadata.industry,callback:function(t){e.$set(e.resource.data.metadata,"industry",t)},expression:"resource.data.metadata['industry']"}})]}}],null,!0)}),e._v(" "),e._l(e.resource.data.metadata,(function(t,s){return a("input",{attrs:{type:"hidden",name:"metadata["+s+"]"},domProps:{value:e.resource.data.metadata[s]}})}))],2)],1)],2),e._v(" "),a("v-tab-item",{key:"tab-1"},[e.isFetchingResource?[a("skeleton-edit-financial")]:e._e(),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isFinishedFetchingResource,expression:"isFinishedFetchingResource"}]},[a("v-card",{staticClass:"mb-3"},[a("v-card-title",[e._v(e._s(e.trans("Income Statement")))]),e._v(" "),a("v-card-text",{staticStyle:{"overflow-x":"auto"}},[a("v-simple-table",{staticClass:"transparent mb-3",staticStyle:{"min-width":"800px"}},[a("tbody",[a("tr",{staticStyle:{"vertical-align":"top"}},[a("td",{attrs:{colspan:"100%"}}),e._v(" "),a("td",[a("strong",[e._v(e._s(e.trans("Period 1")))])]),e._v(" "),a("td",[a("strong",[e._v(e._s(e.trans("Period 2")))])]),e._v(" "),a("td",[a("strong",[e._v(e._s(e.trans("Period 3"))),a("br"),e._v(e._s(e.trans("(most recent)")))])])]),e._v(" "),e._l(e.resource.metadata.years,(function(t,s){return a("tr",{key:s},[a("td",{attrs:{colspan:t.length?1:"100%"}},[a("div",{staticClass:"year-label",domProps:{innerHTML:e._s(e.trans(s))}})]),e._v(" "),e._l(t,(function(t,r){return a("td",{key:r},[a("v-text-field",{staticClass:"dt-text-field",attrs:{disabled:e.isLoading,name:"metadata[years]["+s+"]["+r+"]",label:e.trans(r),dense:"","hide-details":"",outlined:""},model:{value:e.resource.data.financials.years[s][r],callback:function(t){e.$set(e.resource.data.financials.years[s],r,t)},expression:"resource.data.financials['years'][i][k]"}})],1)}))],2)})),e._v(" "),e._l(e.resource.metadata["fps-qa1"],(function(t,s){return a("tr",{key:s},[a("td",{attrs:{colspan:t.length?1:"100%"},domProps:{innerHTML:e._s(e.trans(s))}}),e._v(" "),e._l(t,(function(t,r){return a("td",{key:r},[a("v-text-field",{staticClass:"dt-text-field",attrs:{disabled:e.isLoading,name:"metadata[fps-qa1]["+s+"]["+r+"]",dense:"","hide-details":"",outlined:""},model:{value:e.resource.data.financials["fps-qa1"][s][r],callback:function(t){e.$set(e.resource.data.financials["fps-qa1"][s],r,t)},expression:"resource.data.financials['fps-qa1'][i][k]"}})],1)}))],2)}))],2)])],1)],1),e._v(" "),a("v-card",{staticClass:"mb-3"},[a("v-card-title",[e._v(e._s(e.trans("Balance Sheet")))]),e._v(" "),a("v-card-text",{staticStyle:{"overflow-x":"auto"}},[a("v-simple-table",{staticClass:"transparent mb-3",staticStyle:{"min-width":"800px"}},[a("tbody",[a("tr",{staticStyle:{"vertical-align":"top"}},[a("td",{attrs:{colspan:"100%"}}),e._v(" "),a("td",[a("strong",[e._v(e._s(e.trans("Period 1")))])]),e._v(" "),a("td",[a("strong",[e._v(e._s(e.trans("Period 2")))])]),e._v(" "),a("td",[a("strong",[e._v(e._s(e.trans("Period 3"))),a("br"),e._v(e._s(e.trans("(most recent)")))])])]),e._v(" "),e._l(e.resource.metadata.years,(function(t,s){return a("tr",{key:s},[a("td",{attrs:{colspan:t.length?1:"100%"}},[a("div",{staticClass:"year-label",domProps:{innerHTML:e._s(e.trans(s))}})]),e._v(" "),e._l(t,(function(t,r){return a("td",{key:r},[a("v-text-field",{staticClass:"dt-text-field",attrs:{disabled:e.isLoading,name:"metadata[years]["+s+"]["+r+"]",label:e.trans(r),dense:"","hide-details":"",outlined:""},model:{value:e.resource.data.financials.years[s][r],callback:function(t){e.$set(e.resource.data.financials.years[s],r,t)},expression:"resource.data.financials['years'][i][k]"}})],1)}))],2)})),e._v(" "),e._l(e.resource.metadata["balance-sheet"],(function(t,s){return a("tr",{key:s},[a("td",{attrs:{colspan:t.length?1:"100%"},domProps:{innerHTML:e._s(e.trans(s))}}),e._v(" "),e._l(t,(function(t,r){return a("td",{key:r},[a("v-text-field",{staticClass:"dt-text-field",attrs:{disabled:e.isLoading,name:"metadata[balance-sheet]["+s+"]["+r+"]",dense:"","hide-details":"",outlined:""},model:{value:e.resource.data.financials["balance-sheet"][s][r],callback:function(t){e.$set(e.resource.data.financials["balance-sheet"][s],r,t)},expression:"resource.data.financials['balance-sheet'][i][k]"}})],1)}))],2)}))],2)])],1)],1)],1)],2)]},proxy:!0}],null,!0),model:{value:e.tabsModel,callback:function(t){e.tabsModel=t},expression:"tabsModel"}})],1)],1)],1)],1)]}}])})],1)}),[],!1,null,null,null);t.default=E.exports;p()(E,{VBadge:h.a,VBtn:b.a,VCard:y.a,VCardText:g.c,VCardTitle:g.d,VCol:x.a,VContainer:k.a,VFadeTransition:w.c,VForm:C.a,VIcon:P.a,VRow:S.a,VSimpleTable:D.a,VSpacer:F.a,VTabItem:O.a,VTextField:I.a,VToolbarTitle:T.a})}}]);
//# sourceMappingURL=45.js.map